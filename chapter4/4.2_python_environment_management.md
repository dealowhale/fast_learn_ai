# 4.2 Pythonç¯å¢ƒå’Œä¾èµ–ç®¡ç†

åœ¨AIå¼€å‘ä¸­ï¼ŒPythonç¯å¢ƒå’Œä¾èµ–ç®¡ç†æ˜¯ç¡®ä¿é¡¹ç›®ç¨³å®šæ€§å’Œå¯é‡ç°æ€§çš„å…³é”®åŸºç¡€ã€‚æœ¬èŠ‚å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨Trae IDEä¸­é«˜æ•ˆç®¡ç†Pythonç¯å¢ƒï¼ŒåŒ…æ‹¬è™šæ‹Ÿç¯å¢ƒåˆ›å»ºã€ä¾èµ–åŒ…ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶ä»¥åŠæœ€ä½³å®è·µã€‚

## 4.2.1 Pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†

### è™šæ‹Ÿç¯å¢ƒçš„é‡è¦æ€§

è™šæ‹Ÿç¯å¢ƒæ˜¯Pythonå¼€å‘çš„æœ€ä½³å®è·µï¼Œå®ƒèƒ½å¤Ÿï¼š
- ğŸ”’ **éš”ç¦»é¡¹ç›®ä¾èµ–** - é¿å…ä¸åŒé¡¹ç›®é—´çš„åŒ…å†²çª
- ğŸ“¦ **ç‰ˆæœ¬æ§åˆ¶** - ç¡®ä¿æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„åŒ…
- ğŸš€ **éƒ¨ç½²ä¸€è‡´æ€§** - ä¿è¯å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒçš„ä¸€è‡´æ€§
- ğŸ›¡ï¸ **ç³»ç»Ÿä¿æŠ¤** - é¿å…æ±¡æŸ“ç³»ç»ŸPythonç¯å¢ƒ

### åœ¨Traeä¸­åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç¯å¢ƒ

```python
# Pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·
import os
import sys
import subprocess
import json
from pathlib import Path
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
from datetime import datetime

class TraeEnvironmentManager:
    """Traeç¯å¢ƒç®¡ç†å™¨"""
    
    def __init__(self, project_root=None):
        self.project_root = Path(project_root) if project_root else Path.cwd()
        self.venv_dir = self.project_root / '.venv'
        self.requirements_file = self.project_root / 'requirements.txt'
        self.env_config_file = self.project_root / 'environment.json'
        
    def create_virtual_environment(self, python_version=None):
        """åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ"""
        print("=== åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ ===")
        
        # æ£€æŸ¥Pythonç‰ˆæœ¬
        if python_version:
            python_cmd = f'python{python_version}'
        else:
            python_cmd = 'python'
            
        try:
            # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
            cmd = [python_cmd, '-m', 'venv', str(self.venv_dir)]
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            print(f"âœ… è™šæ‹Ÿç¯å¢ƒåˆ›å»ºæˆåŠŸ: {self.venv_dir}")
            
            # è·å–Pythonç‰ˆæœ¬ä¿¡æ¯
            python_info = self.get_python_info()
            
            # ä¿å­˜ç¯å¢ƒé…ç½®
            self.save_environment_config(python_info)
            
            # å‡çº§pip
            self.upgrade_pip()
            
            return True
            
        except subprocess.CalledProcessError as e:
            print(f"âŒ è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå¤±è´¥: {e}")
            return False
    
    def get_python_info(self):
        """è·å–Pythonç¯å¢ƒä¿¡æ¯"""
        if os.name == 'nt':  # Windows
            python_exe = self.venv_dir / 'Scripts' / 'python.exe'
        else:  # Unix/Linux/macOS
            python_exe = self.venv_dir / 'bin' / 'python'
            
        try:
            # è·å–Pythonç‰ˆæœ¬
            version_result = subprocess.run(
                [str(python_exe), '--version'], 
                capture_output=True, text=True, check=True
            )
            
            # è·å–pipç‰ˆæœ¬
            pip_result = subprocess.run(
                [str(python_exe), '-m', 'pip', '--version'], 
                capture_output=True, text=True, check=True
            )
            
            return {
                'python_version': version_result.stdout.strip(),
                'pip_version': pip_result.stdout.strip(),
                'python_executable': str(python_exe),
                'created_at': datetime.now().isoformat(),
                'platform': sys.platform
            }
            
        except subprocess.CalledProcessError as e:
            print(f"âš ï¸ è·å–Pythonä¿¡æ¯å¤±è´¥: {e}")
            return {}
    
    def save_environment_config(self, python_info):
        """ä¿å­˜ç¯å¢ƒé…ç½®"""
        config = {
            'project_name': self.project_root.name,
            'environment_path': str(self.venv_dir),
            'python_info': python_info,
            'requirements_file': str(self.requirements_file),
            'created_at': datetime.now().isoformat()
        }
        
        with open(self.env_config_file, 'w', encoding='utf-8') as f:
            json.dump(config, f, indent=2, ensure_ascii=False)
            
        print(f"ğŸ“ ç¯å¢ƒé…ç½®å·²ä¿å­˜: {self.env_config_file}")
    
    def upgrade_pip(self):
        """å‡çº§pipåˆ°æœ€æ–°ç‰ˆæœ¬"""
        print("\n=== å‡çº§pip ===")
        
        if os.name == 'nt':  # Windows
            pip_exe = self.venv_dir / 'Scripts' / 'pip.exe'
        else:  # Unix/Linux/macOS
            pip_exe = self.venv_dir / 'bin' / 'pip'
            
        try:
            cmd = [str(pip_exe), 'install', '--upgrade', 'pip']
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            print("âœ… pipå‡çº§æˆåŠŸ")
            
        except subprocess.CalledProcessError as e:
            print(f"âš ï¸ pipå‡çº§å¤±è´¥: {e}")
    
    def activate_environment(self):
        """æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (è¿”å›æ¿€æ´»è„šæœ¬è·¯å¾„)"""
        if os.name == 'nt':  # Windows
            activate_script = self.venv_dir / 'Scripts' / 'activate.bat'
        else:  # Unix/Linux/macOS
            activate_script = self.venv_dir / 'bin' / 'activate'
            
        if activate_script.exists():
            print(f"\nğŸ”§ æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ:")
            if os.name == 'nt':
                print(f"   {activate_script}")
            else:
                print(f"   source {activate_script}")
            return str(activate_script)
        else:
            print("âŒ è™šæ‹Ÿç¯å¢ƒä¸å­˜åœ¨ï¼Œè¯·å…ˆåˆ›å»º")
            return None
    
    def list_installed_packages(self):
        """åˆ—å‡ºå·²å®‰è£…çš„åŒ…"""
        print("\n=== å·²å®‰è£…çš„PythonåŒ… ===")
        
        if os.name == 'nt':  # Windows
            pip_exe = self.venv_dir / 'Scripts' / 'pip.exe'
        else:  # Unix/Linux/macOS
            pip_exe = self.venv_dir / 'bin' / 'pip'
            
        try:
            cmd = [str(pip_exe), 'list', '--format=json']
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            packages = json.loads(result.stdout)
            
            if packages:
                # åˆ›å»ºåŒ…ä¿¡æ¯DataFrame
                df = pd.DataFrame(packages)
                print(f"\nğŸ“¦ å…±å®‰è£…äº† {len(packages)} ä¸ªåŒ…:")
                
                # æŒ‰åç§°æ’åºå¹¶æ˜¾ç¤º
                df_sorted = df.sort_values('name')
                for _, package in df_sorted.iterrows():
                    print(f"  â€¢ {package['name']} ({package['version']})")
                
                return packages
            else:
                print("ğŸ“¦ æš‚æ— å·²å®‰è£…çš„åŒ…")
                return []
                
        except subprocess.CalledProcessError as e:
            print(f"âŒ è·å–åŒ…åˆ—è¡¨å¤±è´¥: {e}")
            return []
        except json.JSONDecodeError as e:
            print(f"âŒ è§£æåŒ…ä¿¡æ¯å¤±è´¥: {e}")
            return []

# åˆ›å»ºç¯å¢ƒç®¡ç†å™¨å®ä¾‹
env_manager = TraeEnvironmentManager()

# æ¼”ç¤ºè™šæ‹Ÿç¯å¢ƒåˆ›å»º
print("ğŸš€ å¼€å§‹åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ...")
if env_manager.create_virtual_environment():
    # æ¿€æ´»ç¯å¢ƒ
    activate_script = env_manager.activate_environment()
    
    # åˆ—å‡ºå·²å®‰è£…åŒ…
    packages = env_manager.list_installed_packages()
    
    print("\nâœ¨ è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå®Œæˆï¼")
else:
    print("âŒ è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå¤±è´¥")
```

### è™šæ‹Ÿç¯å¢ƒæœ€ä½³å®è·µ

```python
# è™šæ‹Ÿç¯å¢ƒæœ€ä½³å®è·µæŒ‡å—
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.patches import Rectangle

def create_venv_best_practices_guide():
    """åˆ›å»ºè™šæ‹Ÿç¯å¢ƒæœ€ä½³å®è·µæŒ‡å—"""
    print("=== Pythonè™šæ‹Ÿç¯å¢ƒæœ€ä½³å®è·µ ===")
    
    # åˆ›å»ºæœ€ä½³å®è·µå¯è§†åŒ–
    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(16, 12))
    fig.suptitle('Pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†æœ€ä½³å®è·µ', fontsize=16, fontweight='bold')
    
    # 1. ç¯å¢ƒå‘½åè§„èŒƒ
    naming_conventions = {
        'é¡¹ç›®åç§°': 85,
        'ç‰ˆæœ¬æ ‡è¯†': 75,
        'ç¯å¢ƒç±»å‹': 70,
        'æ—¥æœŸæ ‡è®°': 60,
        'éšæœºå‘½å': 20
    }
    
    names = list(naming_conventions.keys())
    scores = list(naming_conventions.values())
    colors = ['#4CAF50', '#8BC34A', '#FFC107', '#FF9800', '#F44336']
    
    bars = ax1.barh(names, scores, color=colors, alpha=0.8)
    ax1.set_xlabel('æ¨èåº¦è¯„åˆ†', fontsize=11)
    ax1.set_title('è™šæ‹Ÿç¯å¢ƒå‘½åè§„èŒƒ', fontsize=12, fontweight='bold')
    ax1.set_xlim(0, 100)
    
    # æ·»åŠ è¯„åˆ†æ ‡ç­¾
    for bar, score in zip(bars, scores):
        width = bar.get_width()
        ax1.text(width + 2, bar.get_y() + bar.get_height()/2,
                 f'{score}%', ha='left', va='center', fontweight='bold')
    
    # 2. ä¾èµ–ç®¡ç†ç­–ç•¥å¯¹æ¯”
    strategies = ['requirements.txt', 'Pipfile', 'poetry.lock', 'conda.yaml']
    metrics = {
        'æ˜“ç”¨æ€§': [90, 75, 70, 80],
        'åŠŸèƒ½å®Œæ•´æ€§': [60, 85, 95, 90],
        'ç”Ÿæ€å…¼å®¹æ€§': [95, 80, 75, 70],
        'å­¦ä¹ æˆæœ¬': [95, 70, 60, 65]
    }
    
    x_pos = np.arange(len(strategies))
    width = 0.2
    colors_metrics = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4']
    
    for i, (metric, values) in enumerate(metrics.items()):
        ax2.bar(x_pos + i * width, values, width, 
                label=metric, color=colors_metrics[i], alpha=0.8)
    
    ax2.set_xlabel('ä¾èµ–ç®¡ç†å·¥å…·', fontsize=11)
    ax2.set_ylabel('è¯„åˆ† (1-100)', fontsize=11)
    ax2.set_title('ä¾èµ–ç®¡ç†ç­–ç•¥å¯¹æ¯”', fontsize=12, fontweight='bold')
    ax2.set_xticks(x_pos + width * 1.5)
    ax2.set_xticklabels(strategies, rotation=45, ha='right')
    ax2.legend()
    ax2.grid(True, alpha=0.3)
    
    # 3. ç¯å¢ƒç”Ÿå‘½å‘¨æœŸç®¡ç†
    lifecycle_stages = ['åˆ›å»º', 'å¼€å‘', 'æµ‹è¯•', 'éƒ¨ç½²', 'ç»´æŠ¤', 'æ¸…ç†']
    importance_scores = [95, 90, 85, 95, 70, 60]
    complexity_scores = [30, 60, 70, 80, 50, 20]
    
    ax3.scatter(complexity_scores, importance_scores, 
               s=[200, 250, 220, 280, 180, 150], 
               c=['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD'],
               alpha=0.7, edgecolors='black', linewidth=2)
    
    # æ·»åŠ é˜¶æ®µæ ‡ç­¾
    for i, stage in enumerate(lifecycle_stages):
        ax3.annotate(stage, (complexity_scores[i], importance_scores[i]), 
                    xytext=(5, 5), textcoords='offset points', 
                    fontsize=10, fontweight='bold')
    
    ax3.set_xlabel('å¤æ‚åº¦è¯„åˆ†', fontsize=11)
    ax3.set_ylabel('é‡è¦æ€§è¯„åˆ†', fontsize=11)
    ax3.set_title('ç¯å¢ƒç”Ÿå‘½å‘¨æœŸç®¡ç†', fontsize=12, fontweight='bold')
    ax3.grid(True, alpha=0.3)
    ax3.set_xlim(10, 90)
    ax3.set_ylim(50, 100)
    
    # 4. å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ
    problems = ['åŒ…å†²çª', 'ç‰ˆæœ¬ä¸å…¼å®¹', 'ç¯å¢ƒæ±¡æŸ“', 'ä¾èµ–ç¼ºå¤±', 'æƒé™é—®é¢˜']
    solution_effectiveness = [90, 85, 95, 80, 70]
    occurrence_frequency = [60, 70, 40, 80, 30]
    
    # åˆ›å»ºæ°”æ³¡å›¾
    bubble_sizes = [freq * 5 for freq in occurrence_frequency]  # è°ƒæ•´æ°”æ³¡å¤§å°
    colors_problems = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7']
    
    scatter = ax4.scatter(occurrence_frequency, solution_effectiveness, 
                         s=bubble_sizes, c=colors_problems, alpha=0.6, 
                         edgecolors='black', linewidth=1)
    
    # æ·»åŠ é—®é¢˜æ ‡ç­¾
    for i, problem in enumerate(problems):
        ax4.annotate(problem, (occurrence_frequency[i], solution_effectiveness[i]), 
                    xytext=(5, 5), textcoords='offset points', 
                    fontsize=9, fontweight='bold')
    
    ax4.set_xlabel('é—®é¢˜å‘ç”Ÿé¢‘ç‡ (%)', fontsize=11)
    ax4.set_ylabel('è§£å†³æ–¹æ¡ˆæœ‰æ•ˆæ€§ (%)', fontsize=11)
    ax4.set_title('å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ', fontsize=12, fontweight='bold')
    ax4.grid(True, alpha=0.3)
    ax4.set_xlim(20, 90)
    ax4.set_ylim(60, 100)
    
    plt.tight_layout()
    plt.show()
    
    # è¾“å‡ºæœ€ä½³å®è·µå»ºè®®
    print_best_practices()

def print_best_practices():
    """è¾“å‡ºæœ€ä½³å®è·µå»ºè®®"""
    print("\n=== è™šæ‹Ÿç¯å¢ƒæœ€ä½³å®è·µå»ºè®® ===")
    
    practices = {
        'ğŸ—ï¸ ç¯å¢ƒåˆ›å»º': [
            'æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒ',
            'ä½¿ç”¨æœ‰æ„ä¹‰çš„ç¯å¢ƒåç§°',
            'è®°å½•Pythonç‰ˆæœ¬è¦æ±‚',
            'åŠæ—¶å‡çº§pipåˆ°æœ€æ–°ç‰ˆæœ¬'
        ],
        'ğŸ“¦ ä¾èµ–ç®¡ç†': [
            'ä½¿ç”¨requirements.txtå›ºå®šç‰ˆæœ¬',
            'åŒºåˆ†å¼€å‘å’Œç”Ÿäº§ä¾èµ–',
            'å®šæœŸæ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬',
            'é¿å…å®‰è£…ä¸å¿…è¦çš„åŒ…'
        ],
        'ğŸ”§ æ—¥å¸¸ç»´æŠ¤': [
            'å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„ç¯å¢ƒ',
            'å¤‡ä»½é‡è¦çš„ç¯å¢ƒé…ç½®',
            'ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é…ç½®æ–‡ä»¶',
            'æ–‡æ¡£åŒ–ç¯å¢ƒè®¾ç½®æ­¥éª¤'
        ],
        'ğŸš€ éƒ¨ç½²å‡†å¤‡': [
            'ç¡®ä¿requirements.txtå®Œæ•´',
            'æµ‹è¯•ç¯å¢ƒé‡å»ºæµç¨‹',
            'éªŒè¯è·¨å¹³å°å…¼å®¹æ€§',
            'å‡†å¤‡ç¯å¢ƒè¿ç§»è„šæœ¬'
        ]
    }
    
    for category, practice_list in practices.items():
        print(f"\n{category}:")
        for practice in practice_list:
            print(f"  â€¢ {practice}")

# æ‰§è¡Œæœ€ä½³å®è·µæŒ‡å—åˆ›å»º
create_venv_best_practices_guide()
```

## 4.2.2 ä¾èµ–åŒ…ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶

### requirements.txt ç®¡ç†

```python
# ä¾èµ–åŒ…ç®¡ç†å·¥å…·
import subprocess
import json
import re
from pathlib import Path
import pandas as pd
import matplotlib.pyplot as plt
from datetime import datetime

class DependencyManager:
    """ä¾èµ–åŒ…ç®¡ç†å™¨"""
    
    def __init__(self, project_root=None):
        self.project_root = Path(project_root) if project_root else Path.cwd()
        self.requirements_file = self.project_root / 'requirements.txt'
        self.dev_requirements_file = self.project_root / 'requirements-dev.txt'
        self.lock_file = self.project_root / 'requirements.lock'
        
    def generate_requirements(self, include_versions=True, dev_only=False):
        """ç”Ÿæˆrequirements.txtæ–‡ä»¶"""
        print("=== ç”Ÿæˆä¾èµ–æ–‡ä»¶ ===")
        
        try:
            # è·å–å·²å®‰è£…åŒ…åˆ—è¡¨
            cmd = ['pip', 'freeze']
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            installed_packages = result.stdout.strip().split('\n')
            
            # è¿‡æ»¤å’Œåˆ†ç±»åŒ…
            production_packages = []
            dev_packages = []
            
            # å¼€å‘å·¥å…·åŒ…åˆ—è¡¨
            dev_tools = {
                'pytest', 'pytest-cov', 'black', 'flake8', 'mypy', 
                'jupyter', 'notebook', 'ipython', 'sphinx', 'twine',
                'pre-commit', 'isort', 'bandit', 'safety'
            }
            
            for package in installed_packages:
                if package.strip():
                    package_name = package.split('==')[0].lower()
                    
                    if any(dev_tool in package_name for dev_tool in dev_tools):
                        dev_packages.append(package)
                    else:
                        production_packages.append(package)
            
            # å†™å…¥ç”Ÿäº§ä¾èµ–
            if not dev_only:
                with open(self.requirements_file, 'w', encoding='utf-8') as f:
                    f.write("# ç”Ÿäº§ç¯å¢ƒä¾èµ–\n")
                    f.write(f"# ç”Ÿæˆæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
                    
                    # æŒ‰ç±»åˆ«ç»„ç»‡ä¾èµ–
                    categorized_deps = self.categorize_dependencies(production_packages)
                    
                    for category, packages in categorized_deps.items():
                        if packages:
                            f.write(f"# {category}\n")
                            for package in sorted(packages):
                                f.write(f"{package}\n")
                            f.write("\n")
                
                print(f"âœ… ç”Ÿäº§ä¾èµ–æ–‡ä»¶å·²ç”Ÿæˆ: {self.requirements_file}")
                print(f"   åŒ…å« {len(production_packages)} ä¸ªåŒ…")
            
            # å†™å…¥å¼€å‘ä¾èµ–
            if dev_packages:
                with open(self.dev_requirements_file, 'w', encoding='utf-8') as f:
                    f.write("# å¼€å‘ç¯å¢ƒä¾èµ–\n")
                    f.write(f"# ç”Ÿæˆæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
                    f.write("-r requirements.txt\n\n")
                    
                    f.write("# å¼€å‘å·¥å…·\n")
                    for package in sorted(dev_packages):
                        f.write(f"{package}\n")
                
                print(f"âœ… å¼€å‘ä¾èµ–æ–‡ä»¶å·²ç”Ÿæˆ: {self.dev_requirements_file}")
                print(f"   åŒ…å« {len(dev_packages)} ä¸ªå¼€å‘å·¥å…·")
            
            return {
                'production': production_packages,
                'development': dev_packages
            }
            
        except subprocess.CalledProcessError as e:
            print(f"âŒ ç”Ÿæˆä¾èµ–æ–‡ä»¶å¤±è´¥: {e}")
            return None
    
    def categorize_dependencies(self, packages):
        """æŒ‰åŠŸèƒ½åˆ†ç±»ä¾èµ–åŒ…"""
        categories = {
            'Webæ¡†æ¶': [],
            'æ•°æ®ç§‘å­¦': [],
            'æœºå™¨å­¦ä¹ ': [],
            'æ·±åº¦å­¦ä¹ ': [],
            'æ•°æ®åº“': [],
            'å·¥å…·åº“': [],
            'å…¶ä»–': []
        }
        
        # åŒ…åˆ†ç±»è§„åˆ™
        category_rules = {
            'Webæ¡†æ¶': ['django', 'flask', 'fastapi', 'tornado', 'pyramid'],
            'æ•°æ®ç§‘å­¦': ['pandas', 'numpy', 'scipy', 'matplotlib', 'seaborn', 'plotly'],
            'æœºå™¨å­¦ä¹ ': ['scikit-learn', 'xgboost', 'lightgbm', 'catboost'],
            'æ·±åº¦å­¦ä¹ ': ['tensorflow', 'torch', 'keras', 'pytorch'],
            'æ•°æ®åº“': ['sqlalchemy', 'pymongo', 'redis', 'psycopg2'],
            'å·¥å…·åº“': ['requests', 'click', 'pydantic', 'python-dotenv']
        }
        
        for package in packages:
            package_name = package.split('==')[0].lower()
            categorized = False
            
            for category, keywords in category_rules.items():
                if any(keyword in package_name for keyword in keywords):
                    categories[category].append(package)
                    categorized = True
                    break
            
            if not categorized:
                categories['å…¶ä»–'].append(package)
        
        return categories
    
    def install_from_requirements(self, dev=False, upgrade=False):
        """ä»requirementsæ–‡ä»¶å®‰è£…ä¾èµ–"""
        print("=== å®‰è£…é¡¹ç›®ä¾èµ– ===")
        
        req_file = self.dev_requirements_file if dev else self.requirements_file
        
        if not req_file.exists():
            print(f"âŒ ä¾èµ–æ–‡ä»¶ä¸å­˜åœ¨: {req_file}")
            return False
        
        try:
            cmd = ['pip', 'install', '-r', str(req_file)]
            if upgrade:
                cmd.append('--upgrade')
            
            print(f"ğŸ“¦ æ­£åœ¨å®‰è£…ä¾èµ–: {req_file.name}")
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            print("âœ… ä¾èµ–å®‰è£…æˆåŠŸ")
            return True
            
        except subprocess.CalledProcessError as e:
            print(f"âŒ ä¾èµ–å®‰è£…å¤±è´¥: {e}")
            print(f"é”™è¯¯è¾“å‡º: {e.stderr}")
            return False
    
    def check_outdated_packages(self):
        """æ£€æŸ¥è¿‡æ—¶çš„åŒ…"""
        print("\n=== æ£€æŸ¥è¿‡æ—¶çš„åŒ… ===")
        
        try:
            cmd = ['pip', 'list', '--outdated', '--format=json']
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            if result.stdout.strip():
                outdated_packages = json.loads(result.stdout)
                
                if outdated_packages:
                    print(f"\nğŸ“Š å‘ç° {len(outdated_packages)} ä¸ªå¯æ›´æ–°çš„åŒ…:")
                    
                    # åˆ›å»ºDataFrameç”¨äºå±•ç¤º
                    df = pd.DataFrame(outdated_packages)
                    df = df.sort_values('name')
                    
                    for _, package in df.iterrows():
                        print(f"  â€¢ {package['name']}: {package['version']} â†’ {package['latest_version']}")
                    
                    return outdated_packages
                else:
                    print("âœ… æ‰€æœ‰åŒ…éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬")
                    return []
            else:
                print("âœ… æ‰€æœ‰åŒ…éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬")
                return []
                
        except subprocess.CalledProcessError as e:
            print(f"âŒ æ£€æŸ¥æ›´æ–°å¤±è´¥: {e}")
            return None
        except json.JSONDecodeError as e:
            print(f"âŒ è§£ææ›´æ–°ä¿¡æ¯å¤±è´¥: {e}")
            return None
    
    def create_lock_file(self):
        """åˆ›å»ºé”å®šæ–‡ä»¶"""
        print("\n=== åˆ›å»ºä¾èµ–é”å®šæ–‡ä»¶ ===")
        
        try:
            # è·å–ç²¾ç¡®çš„åŒ…ç‰ˆæœ¬ä¿¡æ¯
            cmd = ['pip', 'freeze']
            result = subprocess.run(cmd, capture_output=True, text=True, check=True)
            
            lock_content = {
                'generated_at': datetime.now().isoformat(),
                'python_version': f"{sys.version_info.major}.{sys.version_info.minor}.{sys.version_info.micro}",
                'platform': sys.platform,
                'packages': {}
            }
            
            # è§£æåŒ…ä¿¡æ¯
            for line in result.stdout.strip().split('\n'):
                if line.strip() and '==' in line:
                    name, version = line.split('==')
                    lock_content['packages'][name] = version
            
            # ä¿å­˜é”å®šæ–‡ä»¶
            with open(self.lock_file, 'w', encoding='utf-8') as f:
                json.dump(lock_content, f, indent=2, ensure_ascii=False)
            
            print(f"âœ… é”å®šæ–‡ä»¶å·²åˆ›å»º: {self.lock_file}")
            print(f"   é”å®šäº† {len(lock_content['packages'])} ä¸ªåŒ…çš„ç‰ˆæœ¬")
            
            return lock_content
            
        except subprocess.CalledProcessError as e:
            print(f"âŒ åˆ›å»ºé”å®šæ–‡ä»¶å¤±è´¥: {e}")
            return None

# åˆ›å»ºä¾èµ–ç®¡ç†å™¨å®ä¾‹
dep_manager = DependencyManager()

# æ¼”ç¤ºä¾èµ–ç®¡ç†åŠŸèƒ½
print("ğŸ”§ å¼€å§‹ä¾èµ–åŒ…ç®¡ç†...")

# ç”Ÿæˆrequirementsæ–‡ä»¶
dependencies = dep_manager.generate_requirements()

if dependencies:
    print(f"\nğŸ“Š ä¾èµ–ç»Ÿè®¡:")
    print(f"  ç”Ÿäº§ç¯å¢ƒ: {len(dependencies['production'])} ä¸ªåŒ…")
    print(f"  å¼€å‘ç¯å¢ƒ: {len(dependencies['development'])} ä¸ªåŒ…")
    
    # æ£€æŸ¥è¿‡æ—¶çš„åŒ…
    outdated = dep_manager.check_outdated_packages()
    
    # åˆ›å»ºé”å®šæ–‡ä»¶
    lock_info = dep_manager.create_lock_file()
```

### ä¾èµ–ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

```python
# ç‰ˆæœ¬ç®¡ç†å’Œå†²çªè§£å†³å·¥å…·
import re
import requests
from packaging import version
import matplotlib.pyplot as plt
import networkx as nx
from collections import defaultdict

class VersionManager:
    """ç‰ˆæœ¬ç®¡ç†å™¨"""
    
    def __init__(self):
        self.version_patterns = {
            'exact': r'^([a-zA-Z0-9_-]+)==([0-9.]+)$',
            'minimum': r'^([a-zA-Z0-9_-]+)>=([0-9.]+)$',
            'compatible': r'^([a-zA-Z0-9_-]+)~=([0-9.]+)$',
            'range': r'^([a-zA-Z0-9_-]+)>=([0-9.]+),<([0-9.]+)$'
        }
    
    def analyze_version_constraints(self, requirements_content):
        """åˆ†æç‰ˆæœ¬çº¦æŸ"""
        print("=== ç‰ˆæœ¬çº¦æŸåˆ†æ ===")
        
        constraints = {
            'exact': [],      # ç²¾ç¡®ç‰ˆæœ¬ ==
            'minimum': [],    # æœ€å°ç‰ˆæœ¬ >=
            'compatible': [], # å…¼å®¹ç‰ˆæœ¬ ~=
            'range': [],      # ç‰ˆæœ¬èŒƒå›´
            'unconstrained': [] # æ— çº¦æŸ
        }
        
        lines = requirements_content.strip().split('\n')
        
        for line in lines:
            line = line.strip()
            if not line or line.startswith('#'):
                continue
            
            # æ£€æŸ¥å„ç§ç‰ˆæœ¬çº¦æŸæ¨¡å¼
            constraint_found = False
            
            for constraint_type, pattern in self.version_patterns.items():
                match = re.match(pattern, line)
                if match:
                    constraints[constraint_type].append({
                        'package': match.group(1),
                        'version': match.group(2),
                        'line': line
                    })
                    constraint_found = True
                    break
            
            if not constraint_found and '==' not in line and '>=' not in line:
                # æ— ç‰ˆæœ¬çº¦æŸçš„åŒ…
                package_name = line.split()[0] if line else ''
                if package_name:
                    constraints['unconstrained'].append({
                        'package': package_name,
                        'line': line
                    })
        
        # è¾“å‡ºåˆ†æç»“æœ
        total_packages = sum(len(packages) for packages in constraints.values())
        print(f"\nğŸ“Š ç‰ˆæœ¬çº¦æŸç»Ÿè®¡ (å…± {total_packages} ä¸ªåŒ…):")
        
        for constraint_type, packages in constraints.items():
            if packages:
                print(f"  â€¢ {constraint_type}: {len(packages)} ä¸ªåŒ…")
                for pkg in packages[:3]:  # æ˜¾ç¤ºå‰3ä¸ªç¤ºä¾‹
                    print(f"    - {pkg['line']}")
                if len(packages) > 3:
                    print(f"    ... è¿˜æœ‰ {len(packages) - 3} ä¸ª")
        
        return constraints
    
    def suggest_version_strategy(self, package_name, current_version=None):
        """å»ºè®®ç‰ˆæœ¬ç®¡ç†ç­–ç•¥"""
        print(f"\n=== {package_name} ç‰ˆæœ¬ç­–ç•¥å»ºè®® ===")
        
        strategies = {
            'ç²¾ç¡®å›ºå®š (==)': {
                'pros': ['å®Œå…¨å¯é‡ç°', 'é¿å…æ„å¤–æ›´æ–°', 'éƒ¨ç½²ä¸€è‡´æ€§'],
                'cons': ['æ— æ³•è·å¾—bugä¿®å¤', 'å®‰å…¨æ›´æ–°æ»å', 'ç»´æŠ¤æˆæœ¬é«˜'],
                'use_case': 'ç”Ÿäº§ç¯å¢ƒã€å…³é”®ç³»ç»Ÿ',
                'example': f'{package_name}==1.2.3'
            },
            'å…¼å®¹ç‰ˆæœ¬ (~=)': {
                'pros': ['è‡ªåŠ¨è·å¾—è¡¥ä¸æ›´æ–°', 'ä¿æŒAPIå…¼å®¹', 'å¹³è¡¡ç¨³å®šæ€§'],
                'cons': ['å¯èƒ½å¼•å…¥å°é—®é¢˜', 'éœ€è¦å®šæœŸæµ‹è¯•'],
                'use_case': 'å¤§å¤šæ•°é¡¹ç›®çš„æ¨èé€‰æ‹©',
                'example': f'{package_name}~=1.2.0'
            },
            'æœ€å°ç‰ˆæœ¬ (>=)': {
                'pros': ['çµæ´»æ€§æœ€é«˜', 'è‡ªåŠ¨è·å¾—æ‰€æœ‰æ›´æ–°', 'åŠŸèƒ½æœ€æ–°'],
                'cons': ['å¯èƒ½ç ´åå…¼å®¹æ€§', 'ä¸å¯é¢„æµ‹', 'æµ‹è¯•è´Ÿæ‹…é‡'],
                'use_case': 'å¼€å‘ç¯å¢ƒã€å®éªŒé¡¹ç›®',
                'example': f'{package_name}>=1.2.0'
            },
            'ç‰ˆæœ¬èŒƒå›´': {
                'pros': ['ç²¾ç¡®æ§åˆ¶æ›´æ–°èŒƒå›´', 'å¹³è¡¡ç¨³å®šæ€§å’Œæ›´æ–°'],
                'cons': ['é…ç½®å¤æ‚', 'éœ€è¦æ·±å…¥äº†è§£ç‰ˆæœ¬è¯­ä¹‰'],
                'use_case': 'å¤æ‚é¡¹ç›®ã€å¤šç¯å¢ƒéƒ¨ç½²',
                'example': f'{package_name}>=1.2.0,<2.0.0'
            }
        }
        
        for strategy, details in strategies.items():
            print(f"\nğŸ”§ {strategy}:")
            print(f"   ç¤ºä¾‹: {details['example']}")
            print(f"   é€‚ç”¨: {details['use_case']}")
            print(f"   ä¼˜ç‚¹: {', '.join(details['pros'])}")
            print(f"   ç¼ºç‚¹: {', '.join(details['cons'])}")
        
        return strategies
    
    def detect_dependency_conflicts(self, requirements_file):
        """æ£€æµ‹ä¾èµ–å†²çª"""
        print("\n=== ä¾èµ–å†²çªæ£€æµ‹ ===")
        
        try:
            # ä½¿ç”¨pip-toolsæ£€æŸ¥å†²çª
            cmd = ['pip-compile', '--dry-run', str(requirements_file)]
            result = subprocess.run(cmd, capture_output=True, text=True)
            
            conflicts = []
            
            if result.returncode != 0:
                # è§£æé”™è¯¯ä¿¡æ¯ä¸­çš„å†²çª
                error_lines = result.stderr.split('\n')
                for line in error_lines:
                    if 'conflict' in line.lower() or 'incompatible' in line.lower():
                        conflicts.append(line.strip())
            
            if conflicts:
                print(f"âš ï¸ å‘ç° {len(conflicts)} ä¸ªæ½œåœ¨å†²çª:")
                for conflict in conflicts:
                    print(f"  â€¢ {conflict}")
            else:
                print("âœ… æœªå‘ç°æ˜æ˜¾çš„ä¾èµ–å†²çª")
            
            return conflicts
            
        except FileNotFoundError:
            print("âš ï¸ pip-toolsæœªå®‰è£…ï¼Œæ— æ³•è¿›è¡Œå†²çªæ£€æµ‹")
            print("   å®‰è£…å‘½ä»¤: pip install pip-tools")
            return []
        except Exception as e:
            print(f"âŒ å†²çªæ£€æµ‹å¤±è´¥: {e}")
            return []

# åˆ›å»ºç‰ˆæœ¬ç®¡ç†å™¨
version_manager = VersionManager()

# ç¤ºä¾‹requirementså†…å®¹
sample_requirements = """
# Webæ¡†æ¶
django==4.2.7
flask>=2.0.0
fastapi~=0.104.0

# æ•°æ®ç§‘å­¦
pandas>=1.5.0,<3.0.0
numpy==1.24.3
matplotlib~=3.7.0

# æœºå™¨å­¦ä¹ 
scikit-learn
tensorflow>=2.13.0
torch==2.1.0
"""

# åˆ†æç‰ˆæœ¬çº¦æŸ
constraints = version_manager.analyze_version_constraints(sample_requirements)

# æä¾›ç‰ˆæœ¬ç­–ç•¥å»ºè®®
version_manager.suggest_version_strategy('pandas', '1.5.3')
```

## 4.2.3 å¸¸ç”¨AIå¼€å‘åŒ…å®‰è£…æŒ‡å—

### æ ¸å¿ƒAIå¼€å‘åŒ…

```python
# AIå¼€å‘åŒ…å®‰è£…å’Œé…ç½®æŒ‡å—
import subprocess
import sys
import importlib
from pathlib import Path
import matplotlib.pyplot as plt
import numpy as np

class AIPackageInstaller:
    """AIå¼€å‘åŒ…å®‰è£…å™¨"""
    
    def __init__(self):
        self.ai_packages = {
            'æ•°æ®ç§‘å­¦åŸºç¡€': {
                'numpy': 'pip install numpy',
                'pandas': 'pip install pandas',
                'matplotlib': 'pip install matplotlib',
                'seaborn': 'pip install seaborn',
                'scipy': 'pip install scipy',
                'plotly': 'pip install plotly'
            },
            'æœºå™¨å­¦ä¹ ': {
                'scikit-learn': 'pip install scikit-learn',
                'xgboost': 'pip install xgboost',
                'lightgbm': 'pip install lightgbm',
                'catboost': 'pip install catboost'
            },
            'æ·±åº¦å­¦ä¹ ': {
                'tensorflow': 'pip install tensorflow',
                'torch': 'pip install torch torchvision torchaudio',
                'keras': 'pip install keras',
                'transformers': 'pip install transformers'
            },
            'è‡ªç„¶è¯­è¨€å¤„ç†': {
                'nltk': 'pip install nltk',
                'spacy': 'pip install spacy',
                'gensim': 'pip install gensim',
                'textblob': 'pip install textblob'
            },
            'è®¡ç®—æœºè§†è§‰': {
                'opencv-python': 'pip install opencv-python',
                'pillow': 'pip install pillow',
                'imageio': 'pip install imageio',
                'albumentations': 'pip install albumentations'
            },
            'å¼€å‘å·¥å…·': {
                'jupyter': 'pip install jupyter',
                'notebook': 'pip install notebook',
                'ipython': 'pip install ipython',
                'tqdm': 'pip install tqdm'
            }
        }
    
    def check_package_installation(self, package_name):
        """æ£€æŸ¥åŒ…æ˜¯å¦å·²å®‰è£…"""
        try:
            importlib.import_module(package_name)
            return True
        except ImportError:
            return False
    
    def install_package_category(self, category):
        """å®‰è£…æŒ‡å®šç±»åˆ«çš„åŒ…"""
        if category not in self.ai_packages:
            print(f"âŒ æœªçŸ¥ç±»åˆ«: {category}")
            return False
        
        print(f"\n=== å®‰è£… {category} ç›¸å…³åŒ… ===")
        
        packages = self.ai_packages[category]
        success_count = 0
        
        for package_name, install_cmd in packages.items():
            print(f"\nğŸ“¦ å®‰è£… {package_name}...")
            
            # æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
            if self.check_package_installation(package_name.replace('-', '_')):
                print(f"âœ… {package_name} å·²å®‰è£…")
                success_count += 1
                continue
            
            try:
                # æ‰§è¡Œå®‰è£…å‘½ä»¤
                result = subprocess.run(
                    install_cmd.split(), 
                    capture_output=True, 
                    text=True, 
                    check=True
                )
                print(f"âœ… {package_name} å®‰è£…æˆåŠŸ")
                success_count += 1
                
            except subprocess.CalledProcessError as e:
                print(f"âŒ {package_name} å®‰è£…å¤±è´¥: {e}")
                print(f"   é”™è¯¯ä¿¡æ¯: {e.stderr}")
        
        print(f"\nğŸ“Š å®‰è£…ç»“æœ: {success_count}/{len(packages)} ä¸ªåŒ…å®‰è£…æˆåŠŸ")
        return success_count == len(packages)
    
    def create_ai_environment_template(self):
        """åˆ›å»ºAIå¼€å‘ç¯å¢ƒæ¨¡æ¿"""
        print("\n=== åˆ›å»ºAIå¼€å‘ç¯å¢ƒæ¨¡æ¿ ===")
        
        # åŸºç¡€AIå¼€å‘ç¯å¢ƒrequirements
        ai_requirements = {
            'basic': [
                'numpy>=1.21.0',
                'pandas>=1.3.0',
                'matplotlib>=3.5.0',
                'seaborn>=0.11.0',
                'scipy>=1.7.0',
                'scikit-learn>=1.0.0',
                'jupyter>=1.0.0',
                'notebook>=6.4.0',
                'tqdm>=4.62.0'
            ],
            'ml_advanced': [
                'xgboost>=1.5.0',
                'lightgbm>=3.3.0',
                'catboost>=1.0.0',
                'optuna>=2.10.0',
                'shap>=0.40.0'
            ],
            'deep_learning': [
                'tensorflow>=2.8.0',
                'torch>=1.12.0',
                'torchvision>=0.13.0',
                'transformers>=4.20.0',
                'datasets>=2.0.0'
            ],
            'nlp': [
                'nltk>=3.7',
                'spacy>=3.4.0',
                'gensim>=4.2.0',
                'textblob>=0.17.0'
            ],
            'cv': [
                'opencv-python>=4.6.0',
                'pillow>=9.0.0',
                'imageio>=2.19.0',
                'albumentations>=1.2.0'
            ]
        }
        
        # åˆ›å»ºä¸åŒçº§åˆ«çš„requirementsæ–‡ä»¶
        templates = {
            'requirements-basic.txt': ai_requirements['basic'],
            'requirements-ml.txt': ai_requirements['basic'] + ai_requirements['ml_advanced'],
            'requirements-dl.txt': ai_requirements['basic'] + ai_requirements['deep_learning'],
            'requirements-nlp.txt': ai_requirements['basic'] + ai_requirements['nlp'],
            'requirements-cv.txt': ai_requirements['basic'] + ai_requirements['cv'],
            'requirements-full.txt': (
                ai_requirements['basic'] + 
                ai_requirements['ml_advanced'] + 
                ai_requirements['deep_learning'] + 
                ai_requirements['nlp'] + 
                ai_requirements['cv']
            )
        }
        
        for filename, packages in templates.items():
            filepath = Path(filename)
            
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(f"# AIå¼€å‘ç¯å¢ƒ - {filename.replace('requirements-', '').replace('.txt', '')}\n")
                f.write(f"# ç”Ÿæˆæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
                
                for package in sorted(set(packages)):
                    f.write(f"{package}\n")
            
            print(f"âœ… æ¨¡æ¿å·²åˆ›å»º: {filepath} ({len(set(packages))} ä¸ªåŒ…)")
        
        return templates
    
    def visualize_package_ecosystem(self):
        """å¯è§†åŒ–AIåŒ…ç”Ÿæ€ç³»ç»Ÿ"""
        print("\n=== AIåŒ…ç”Ÿæ€ç³»ç»Ÿå¯è§†åŒ– ===")
        
        # åˆ›å»ºåŒ…ä¾èµ–å…³ç³»å›¾
        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(16, 12))
        fig.suptitle('AIå¼€å‘åŒ…ç”Ÿæ€ç³»ç»Ÿåˆ†æ', fontsize=16, fontweight='bold')
        
        # 1. åŒ…ç±»åˆ«åˆ†å¸ƒ
        categories = list(self.ai_packages.keys())
        package_counts = [len(packages) for packages in self.ai_packages.values()]
        colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD']
        
        ax1.pie(package_counts, labels=categories, colors=colors, autopct='%1.1f%%',
                startangle=90)
        ax1.set_title('AIåŒ…ç±»åˆ«åˆ†å¸ƒ', fontsize=12, fontweight='bold')
        
        # 2. å®‰è£…å¤æ‚åº¦è¯„ä¼°
        complexity_scores = {
            'æ•°æ®ç§‘å­¦åŸºç¡€': 2,
            'æœºå™¨å­¦ä¹ ': 4,
            'æ·±åº¦å­¦ä¹ ': 8,
            'è‡ªç„¶è¯­è¨€å¤„ç†': 6,
            'è®¡ç®—æœºè§†è§‰': 7,
            'å¼€å‘å·¥å…·': 3
        }
        
        importance_scores = {
            'æ•°æ®ç§‘å­¦åŸºç¡€': 10,
            'æœºå™¨å­¦ä¹ ': 9,
            'æ·±åº¦å­¦ä¹ ': 8,
            'è‡ªç„¶è¯­è¨€å¤„ç†': 7,
            'è®¡ç®—æœºè§†è§‰': 7,
            'å¼€å‘å·¥å…·': 8
        }
        
        x_complexity = [complexity_scores[cat] for cat in categories]
        y_importance = [importance_scores[cat] for cat in categories]
        sizes = [count * 20 for count in package_counts]
        
        scatter = ax2.scatter(x_complexity, y_importance, s=sizes, 
                             c=colors, alpha=0.6, edgecolors='black')
        
        for i, cat in enumerate(categories):
            ax2.annotate(cat.replace('è‡ªç„¶è¯­è¨€å¤„ç†', 'NLP').replace('è®¡ç®—æœºè§†è§‰', 'CV'), 
                        (x_complexity[i], y_importance[i]), 
                        xytext=(5, 5), textcoords='offset points', 
                        fontsize=9, fontweight='bold')
        
        ax2.set_xlabel('å®‰è£…å¤æ‚åº¦', fontsize=11)
        ax2.set_ylabel('é‡è¦æ€§è¯„åˆ†', fontsize=11)
        ax2.set_title('åŒ…ç±»åˆ«é‡è¦æ€§vså¤æ‚åº¦', fontsize=12, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        
        # 3. å­¦ä¹ è·¯å¾„æ¨è
        learning_path = {
            'ç¬¬1é˜¶æ®µ\nåŸºç¡€å·¥å…·': ['numpy', 'pandas', 'matplotlib'],
            'ç¬¬2é˜¶æ®µ\næœºå™¨å­¦ä¹ ': ['scikit-learn', 'jupyter'],
            'ç¬¬3é˜¶æ®µ\næ·±åº¦å­¦ä¹ ': ['tensorflow', 'torch'],
            'ç¬¬4é˜¶æ®µ\nä¸“ä¸šé¢†åŸŸ': ['transformers', 'opencv-python']
        }
        
        stages = list(learning_path.keys())
        stage_counts = [len(packages) for packages in learning_path.values()]
        
        bars = ax3.bar(range(len(stages)), stage_counts, 
                      color=['#96CEB4', '#45B7D1', '#FF6B6B', '#FFEAA7'], alpha=0.8)
        
        ax3.set_xlabel('å­¦ä¹ é˜¶æ®µ', fontsize=11)
        ax3.set_ylabel('æ¨èåŒ…æ•°é‡', fontsize=11)
        ax3.set_title('AIå­¦ä¹ è·¯å¾„è§„åˆ’', fontsize=12, fontweight='bold')
        ax3.set_xticks(range(len(stages)))
        ax3.set_xticklabels(stages, rotation=45, ha='right')
        
        # æ·»åŠ åŒ…åæ ‡ç­¾
        for bar, packages in zip(bars, learning_path.values()):
            height = bar.get_height()
            package_names = ', '.join(packages)
            ax3.text(bar.get_x() + bar.get_width()/2., height + 0.1,
                     package_names, ha='center', va='bottom', 
                     fontsize=8, rotation=0)
        
        # 4. ç¯å¢ƒé…ç½®å»ºè®®
        env_types = ['è½»é‡çº§', 'æ ‡å‡†ç‰ˆ', 'å®Œæ•´ç‰ˆ', 'ä¸“ä¸šç‰ˆ']
        package_nums = [10, 25, 45, 60]
        disk_space = [500, 2000, 8000, 15000]  # MB
        
        ax4_twin = ax4.twinx()
        
        bars1 = ax4.bar([x - 0.2 for x in range(len(env_types))], package_nums, 
                       width=0.4, label='åŒ…æ•°é‡', color='#4ECDC4', alpha=0.8)
        bars2 = ax4_twin.bar([x + 0.2 for x in range(len(env_types))], disk_space, 
                            width=0.4, label='ç£ç›˜ç©ºé—´(MB)', color='#FF6B6B', alpha=0.8)
        
        ax4.set_xlabel('ç¯å¢ƒç±»å‹', fontsize=11)
        ax4.set_ylabel('åŒ…æ•°é‡', fontsize=11, color='#4ECDC4')
        ax4_twin.set_ylabel('ç£ç›˜ç©ºé—´ (MB)', fontsize=11, color='#FF6B6B')
        ax4.set_title('ç¯å¢ƒé…ç½®æ–¹æ¡ˆå¯¹æ¯”', fontsize=12, fontweight='bold')
        ax4.set_xticks(range(len(env_types)))
        ax4.set_xticklabels(env_types)
        
        # æ·»åŠ å›¾ä¾‹
        lines1, labels1 = ax4.get_legend_handles_labels()
        lines2, labels2 = ax4_twin.get_legend_handles_labels()
        ax4.legend(lines1 + lines2, labels1 + labels2, loc='upper left')
        
        plt.tight_layout()
        plt.show()

# åˆ›å»ºAIåŒ…å®‰è£…å™¨
ai_installer = AIPackageInstaller()

# åˆ›å»ºç¯å¢ƒæ¨¡æ¿
templates = ai_installer.create_ai_environment_template()

# å¯è§†åŒ–åŒ…ç”Ÿæ€ç³»ç»Ÿ
ai_installer.visualize_package_ecosystem()

print("\nğŸ¯ AIå¼€å‘ç¯å¢ƒé…ç½®å»ºè®®:")
print("\nğŸ”° åˆå­¦è€… (è½»é‡çº§):")
print("  pip install -r requirements-basic.txt")
print("\nğŸ“ˆ è¿›é˜¶è€… (æ ‡å‡†ç‰ˆ):")
print("  pip install -r requirements-ml.txt")
print("\nğŸš€ ä¸“ä¸šè€… (å®Œæ•´ç‰ˆ):")
print("  pip install -r requirements-full.txt")
```

## 4.2.4 ç¯å¢ƒé…ç½®æœ€ä½³å®è·µ

### é…ç½®æ–‡ä»¶ç®¡ç†

```python
# ç¯å¢ƒé…ç½®ç®¡ç†å·¥å…·
import os
import json
import yaml
from pathlib import Path
from datetime import datetime

class EnvironmentConfigManager:
    """ç¯å¢ƒé…ç½®ç®¡ç†å™¨"""
    
    def __init__(self, project_root=None):
        self.project_root = Path(project_root) if project_root else Path.cwd()
        self.config_dir = self.project_root / '.config'
        self.config_dir.mkdir(exist_ok=True)
        
    def create_environment_config(self):
        """åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶"""
        print("=== åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶ ===")
        
        # 1. .env æ–‡ä»¶ (ç¯å¢ƒå˜é‡)
        env_content = """
# é¡¹ç›®ç¯å¢ƒå˜é‡é…ç½®
# å¼€å‘ç¯å¢ƒè®¾ç½®
DEBUG=True
ENVIRONMENT=development

# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///./data/app.db
REDIS_URL=redis://localhost:6379/0

# APIé…ç½®
API_KEY=your_api_key_here
SECRET_KEY=your_secret_key_here

# æ¨¡å‹é…ç½®
MODEL_PATH=./models
DATA_PATH=./data
LOG_LEVEL=INFO

# GPUé…ç½®
CUDA_VISIBLE_DEVICES=0
TF_FORCE_GPU_ALLOW_GROWTH=true
"""
        
        env_file = self.project_root / '.env'
        with open(env_file, 'w', encoding='utf-8') as f:
            f.write(env_content.strip())
        print(f"âœ… ç¯å¢ƒå˜é‡æ–‡ä»¶å·²åˆ›å»º: {env_file}")
        
        # 2. pyproject.toml (é¡¹ç›®é…ç½®)
        pyproject_content = """
[build-system]
requires = ["setuptools>=45", "wheel", "setuptools_scm[toml]>=6.2"]
build-backend = "setuptools.build_meta"

[project]
name = "ai-project"
version = "0.1.0"
description = "AIé¡¹ç›®æ¨¡æ¿"
authors = [{name = "Your Name", email = "your.email@example.com"}]
requires-python = ">=3.8"
dependencies = [
    "numpy>=1.21.0",
    "pandas>=1.3.0",
    "scikit-learn>=1.0.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=6.0",
    "black>=22.0",
    "flake8>=4.0",
    "mypy>=0.950",
]

[tool.black]
line-length = 88
target-version = ['py38']

[tool.isort]
profile = "black"

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
"""
        
        pyproject_file = self.project_root / 'pyproject.toml'
        with open(pyproject_file, 'w', encoding='utf-8') as f:
            f.write(pyproject_content.strip())
        print(f"âœ… é¡¹ç›®é…ç½®æ–‡ä»¶å·²åˆ›å»º: {pyproject_file}")
        
        # 3. setup.cfg (å·¥å…·é…ç½®)
        setup_cfg_content = """
[metadata]
name = ai-project
version = 0.1.0
description = AIé¡¹ç›®æ¨¡æ¿
long_description = file: README.md
long_description_content_type = text/markdown

[options]
packages = find:
python_requires = >=3.8
install_requires =
    numpy>=1.21.0
    pandas>=1.3.0
    scikit-learn>=1.0.0

[options.extras_require]
dev =
    pytest>=6.0
    black>=22.0
    flake8>=4.0
    mypy>=0.950

[flake8]
max-line-length = 88
extend-ignore = E203, W503
exclude = .git,__pycache__,build,dist

[mypy]
python_version = 3.8
warn_return_any = True
warn_unused_configs = True
disallow_untyped_defs = True
"""
        
        setup_cfg_file = self.project_root / 'setup.cfg'
        with open(setup_cfg_file, 'w', encoding='utf-8') as f:
            f.write(setup_cfg_content.strip())
        print(f"âœ… å·¥å…·é…ç½®æ–‡ä»¶å·²åˆ›å»º: {setup_cfg_file}")
        
        # 4. .gitignore
        gitignore_content = """
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Virtual Environment
.venv/
venv/
ENV/
env/

# IDE
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Project specific
.env
*.log
data/
models/
checkpoints/
*.pkl
*.joblib

# Jupyter
.ipynb_checkpoints/

# ML/AI
*.h5
*.pb
*.onnx
wandb/
mlruns/
"""
        
        gitignore_file = self.project_root / '.gitignore'
        with open(gitignore_file, 'w', encoding='utf-8') as f:
            f.write(gitignore_content.strip())
        print(f"âœ… Gitå¿½ç•¥æ–‡ä»¶å·²åˆ›å»º: {gitignore_file}")
        
        return {
            'env': env_file,
            'pyproject': pyproject_file,
            'setup_cfg': setup_cfg_file,
            'gitignore': gitignore_file
        }
    
    def create_development_scripts(self):
        """åˆ›å»ºå¼€å‘è„šæœ¬"""
        print("\n=== åˆ›å»ºå¼€å‘è„šæœ¬ ===")
        
        scripts_dir = self.project_root / 'scripts'
        scripts_dir.mkdir(exist_ok=True)
        
        # 1. ç¯å¢ƒè®¾ç½®è„šæœ¬
        setup_script = """
#!/bin/bash
# å¼€å‘ç¯å¢ƒè®¾ç½®è„šæœ¬

echo "ğŸš€ è®¾ç½®AIå¼€å‘ç¯å¢ƒ..."

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
if [ ! -d ".venv" ]; then
    echo "ğŸ“¦ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ..."
    python -m venv .venv
fi

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
echo "ğŸ”§ æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ..."
source .venv/bin/activate

# å‡çº§pip
echo "â¬†ï¸ å‡çº§pip..."
pip install --upgrade pip

# å®‰è£…ä¾èµ–
echo "ğŸ“š å®‰è£…é¡¹ç›®ä¾èµ–..."
if [ -f "requirements.txt" ]; then
    pip install -r requirements.txt
fi

if [ -f "requirements-dev.txt" ]; then
    pip install -r requirements-dev.txt
fi

# å®‰è£…é¡¹ç›®æœ¬èº«
echo "ğŸ”¨ å®‰è£…é¡¹ç›®..."
pip install -e .

echo "âœ… ç¯å¢ƒè®¾ç½®å®Œæˆï¼"
echo "ğŸ’¡ ä½¿ç”¨ 'source .venv/bin/activate' æ¿€æ´»ç¯å¢ƒ"
"""
        
        setup_file = scripts_dir / 'setup_env.sh'
        with open(setup_file, 'w', encoding='utf-8') as f:
            f.write(setup_script.strip())
        setup_file.chmod(0o755)  # æ·»åŠ æ‰§è¡Œæƒé™
        print(f"âœ… ç¯å¢ƒè®¾ç½®è„šæœ¬å·²åˆ›å»º: {setup_file}")
        
        # 2. ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬
        quality_script = """
#!/bin/bash
# ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬

echo "ğŸ” è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥..."

# ä»£ç æ ¼å¼åŒ–
echo "ğŸ¨ æ ¼å¼åŒ–ä»£ç ..."
black .
isort .

# ä»£ç æ£€æŸ¥
echo "ğŸ” è¿è¡Œflake8æ£€æŸ¥..."
flake8 .

# ç±»å‹æ£€æŸ¥
echo "ğŸ”¬ è¿è¡Œmypyç±»å‹æ£€æŸ¥..."
mypy .

# è¿è¡Œæµ‹è¯•
echo "ğŸ§ª è¿è¡Œæµ‹è¯•..."
pytest tests/ -v --cov=.

echo "âœ… ä»£ç è´¨é‡æ£€æŸ¥å®Œæˆï¼"
"""
        
        quality_file = scripts_dir / 'check_quality.sh'
        with open(quality_file, 'w', encoding='utf-8') as f:
            f.write(quality_script.strip())
        quality_file.chmod(0o755)
        print(f"âœ… è´¨é‡æ£€æŸ¥è„šæœ¬å·²åˆ›å»º: {quality_file}")
        
        return {
            'setup': setup_file,
            'quality': quality_file
        }

# åˆ›å»ºé…ç½®ç®¡ç†å™¨
config_manager = EnvironmentConfigManager()

# åˆ›å»ºé…ç½®æ–‡ä»¶
config_files = config_manager.create_environment_config()

# åˆ›å»ºå¼€å‘è„šæœ¬
scripts = config_manager.create_development_scripts()

print("\nğŸ‰ ç¯å¢ƒé…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆï¼")
print("\nğŸ“ åˆ›å»ºçš„æ–‡ä»¶:")
for file_type, filepath in config_files.items():
    print(f"  â€¢ {file_type}: {filepath.name}")

for script_type, filepath in scripts.items():
    print(f"  â€¢ {script_type} script: {filepath}")
```

## æœ¬èŠ‚æ€»ç»“

é€šè¿‡æœ¬èŠ‚å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†Pythonç¯å¢ƒå’Œä¾èµ–ç®¡ç†çš„æ ¸å¿ƒæŠ€èƒ½ï¼š

### ğŸ¯ æ ¸å¿ƒæˆæœ

1. **è™šæ‹Ÿç¯å¢ƒç®¡ç†** - å­¦ä¼šåˆ›å»ºã€é…ç½®å’Œç®¡ç†Pythonè™šæ‹Ÿç¯å¢ƒ
2. **ä¾èµ–åŒ…ç®¡ç†** - æŒæ¡requirements.txtçš„ç”Ÿæˆå’Œç»´æŠ¤
3. **ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥** - äº†è§£ä¸åŒç‰ˆæœ¬çº¦æŸçš„ä½¿ç”¨åœºæ™¯
4. **AIåŒ…ç”Ÿæ€** - ç†Ÿæ‚‰å¸¸ç”¨AIå¼€å‘åŒ…çš„å®‰è£…å’Œé…ç½®
5. **é…ç½®æ–‡ä»¶ç®¡ç†** - å»ºç«‹æ ‡å‡†åŒ–çš„é¡¹ç›®é…ç½®ä½“ç³»

### ğŸ“Š ç¯å¢ƒç®¡ç†æ£€æŸ¥æ¸…å•

```python
# ç¯å¢ƒç®¡ç†å®Œæˆåº¦æ£€æŸ¥
def create_env_management_checklist():
    """åˆ›å»ºç¯å¢ƒç®¡ç†æ£€æŸ¥æ¸…å•"""
    
    checklist = {
        'è™šæ‹Ÿç¯å¢ƒ': {
            'åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ': True,
            'æ¿€æ´»ç¯å¢ƒ': True,
            'å‡çº§pip': True,
            'ç¯å¢ƒéš”ç¦»': True
        },
        'ä¾èµ–ç®¡ç†': {
            'requirements.txt': True,
            'ç‰ˆæœ¬å›ºå®š': True,
            'ä¾èµ–åˆ†ç±»': True,
            'å†²çªæ£€æµ‹': False
        },
        'é…ç½®æ–‡ä»¶': {
            '.envæ–‡ä»¶': True,
            'pyproject.toml': True,
            '.gitignore': True,
            'å¼€å‘è„šæœ¬': True
        },
        'AIåŒ…å®‰è£…': {
            'åŸºç¡€åŒ…': True,
            'æœºå™¨å­¦ä¹ åŒ…': True,
            'æ·±åº¦å­¦ä¹ åŒ…': False,
            'ä¸“ä¸šåŒ…': False
        }
    }
    
    print("=== Pythonç¯å¢ƒç®¡ç†æ£€æŸ¥æ¸…å• ===")
    
    total_items = 0
    completed_items = 0
    
    for category, items in checklist.items():
        print(f"\nğŸ“‚ {category}:")
        for item, status in items.items():
            status_icon = "âœ…" if status else "â³"
            print(f"  {status_icon} {item}")
            total_items += 1
            if status:
                completed_items += 1
    
    completion_rate = (completed_items / total_items) * 100
    print(f"\nğŸ“Š å®Œæˆåº¦: {completed_items}/{total_items} ({completion_rate:.1f}%)")
    
    return checklist

# æ‰§è¡Œæ£€æŸ¥
checklist_result = create_env_management_checklist()

print("\nğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨:")
print("1. å®Œå–„ä¾èµ–å†²çªæ£€æµ‹æœºåˆ¶")
print("2. å®‰è£…æ·±åº¦å­¦ä¹ ç›¸å…³åŒ…")
print("3. é…ç½®GPUç¯å¢ƒ (å¦‚éœ€è¦)")
print("4. å¼€å§‹ç¬¬ä¸€ä¸ªAIé¡¹ç›®å¼€å‘")
```

### ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“

- **ç¯å¢ƒéš”ç¦»**: æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒ
- **ç‰ˆæœ¬ç®¡ç†**: ä½¿ç”¨åˆé€‚çš„ç‰ˆæœ¬çº¦æŸç­–ç•¥
- **ä¾èµ–åˆ†ç±»**: åŒºåˆ†ç”Ÿäº§å’Œå¼€å‘ä¾èµ–
- **é…ç½®æ ‡å‡†åŒ–**: ä½¿ç”¨æ ‡å‡†é…ç½®æ–‡ä»¶ç®¡ç†é¡¹ç›®
- **è‡ªåŠ¨åŒ–è„šæœ¬**: åˆ›å»ºç¯å¢ƒè®¾ç½®å’Œè´¨é‡æ£€æŸ¥è„šæœ¬

ç°åœ¨ä½ å·²ç»å…·å¤‡äº†å®Œå–„çš„Pythonç¯å¢ƒç®¡ç†èƒ½åŠ›ï¼Œå¯ä»¥ä¸ºä»»ä½•AIé¡¹ç›®åˆ›å»ºç¨³å®šã€å¯é‡ç°çš„å¼€å‘ç¯å¢ƒã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å‡†å¤‡å’Œç®¡ç†AIé¡¹ç›®æ‰€éœ€çš„æ•°æ®é›†ï¼
```